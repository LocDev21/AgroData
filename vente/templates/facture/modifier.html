{% extends 'base.html' %}
{% block title %}Modifier Facture{% endblock %}

{% block content %}
<div class="container mt-4">
	<div class="card shadow-sm p-4 mx-auto" style="max-width:720px;">
		<h1 class="h4 text-center text-success fw-bold mb-3">Modifier la Facture</h1>

		<form method="post">
			{% csrf_token %}
			<div class="mb-3">
				<label class="form-label">Vente</label>
				<select name="vente" class="form-select" required>
					{% for v in ventes %}
						<option value="{{ v.id }}" {% if facture.vente and v.id == facture.vente.id %}selected{% endif %}>{{ v.client.nom }} {{ v.client.prenom }} — {{ v.stock.produit }}</option>
					{% empty %}
						<option value="" disabled>Aucune vente disponible</option>
					{% endfor %}
				</select>
			</div>

			<div class="mb-3">
				<label class="form-label">Numéro de facture</label>
				<input type="number" name="numero_facture" class="form-control" value="{{ facture.numero_facture }}" required>
			</div>

			<div class="mb-3">
				<label class="form-label">Date d'émission</label>
				<input type="date" name="date_emission" class="form-control" value="{{ facture.date_emission|date:'Y-m-d' }}">
			</div>

			<div class="mb-3">
				<label class="form-label">Montant</label>
				<input type="number" step="0.01" name="montant" class="form-control" value="{{ facture.montant }}" required>
			</div>

			<div class="mb-3">
				<label class="form-label">Mode de paiement</label>
				<select name="mode_paiement" class="form-select" required>
					<option value="LIQUIDE" {% if facture.mode_paiement == 'LIQUIDE' %}selected{% endif %}>Liquide</option>
					<option value="OM" {% if facture.mode_paiement == 'OM' %}selected{% endif %}>Orange Money</option>
					<option value="MOMO" {% if facture.mode_paiement == 'MOMO' %}selected{% endif %}>Mobile Money</option>
					<option value="PAYCARD" {% if facture.mode_paiement == 'PAYCARD' %}selected{% endif %}>Paycard</option>
				</select>
			</div>

			<div class="mb-3">
				<label class="form-label">Statut</label>
				<select name="statut" class="form-select" required>
					<option value="PAYER" {% if facture.statut == 'PAYER' %}selected{% endif %}>Payer</option>
					<option value="ATTENTE" {% if facture.statut == 'ATTENTE' %}selected{% endif %}>En Attente</option>
				</select>
			</div>

			<div class="d-grid d-md-flex gap-2">
				<button type="submit" class="btn btn-primary">Modifier</button>
				<a href="{% url 'liste_factures' %}" class="btn btn-secondary">Annuler</a>
			</div>
		</form>
	</div>
</div>
{% endblock %}
